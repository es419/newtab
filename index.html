<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>חלונית מהירה — Google Sheets</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --tile: #1f2937;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --ring: #38bdf8;
    }
    body { margin:0; font-family: system-ui; background:var(--bg); color:var(--text); }
    .wrap { max-width:1100px; margin:24px auto; padding:0 16px; }
    header { display:flex; justify-content:space-between; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(260px,1fr)); gap:12px; margin-top:16px; }
    .tile { background:var(--tile); padding:14px; border-radius:14px; display:flex; flex-direction:column; gap:12px; }
    .actions { display:flex; gap:8px; flex-wrap:wrap; }
    .btn { background:var(--card); padding:10px; border-radius:10px; cursor:pointer; border:1px solid #374151; }
    /* MODAL */
    #editorOverlay { display:none; position:fixed; inset:0; background:#000000aa; backdrop-filter:blur(4px); align-items:center; justify-content:center; z-index:9999; }
    #editorModal { width:60vw; height:60vh; background:var(--card); border-radius:12px; overflow:hidden; display:flex; flex-direction:column; }
    #editorHeader { padding:8px; text-align:left; background:#1e293b; font-size:14px; display:flex; justify-content:space-between; align-items:center; }
    #editorFrame { flex:1; border:0; width:100%; }
    #closeEditor { cursor:pointer; padding:4px 10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header><h2>חלונית מהירה — Sheets</h2></header>
    <div id="grid" class="grid"></div>
  </div>

  <div id="editorOverlay">
    <div id="editorModal">
      <div id="editorHeader">עריכה בגיליון <button id="closeEditor">✕</button></div>
      <iframe id="editorFrame"></iframe>
    </div>
  </div>

<script>
const items=[
 {name:'Sheet #1',url:'https://docs.google.com/spreadsheets/d/1bQMT-RbpUmMPfOd7X8dnJZTM_-N8gXHmggVuL7SPSNE/edit?gid=0#gid=0'},
 {name:'Sheet #2',url:'https://docs.google.com/spreadsheets/d/1YAHsceJD-vO4uIHNNtgc8bDbQ0uhZH-ASLlPiyL-51o/edit?gid=0#gid=0'},
 {name:'Sheet #3',url:'https://docs.google.com/spreadsheets/d/1bSd0GcLaiSLUaE2bhmsFE60DzMlhNeByDhp_gLUF1eM/edit?gid=0#gid=0'}
];

function render(){
  const g=document.getElementById('grid');
  g.innerHTML='';
  items.forEach((it,i)=>{
    const d=document.createElement('div');
    d.className='tile';
    d.innerHTML=`<strong>${i+1}. ${it.name}</strong>
    <div class='actions'>
    <button class='btn' data-i='${i}' data-act='open'>פתח בטאב</button>
    <button class='btn' data-i='${i}' data-act='editHere'>ערוך כאן</button>`;
    g.appendChild(d);
  });
}
render();

function openEditor(url){
  document.getElementById('editorFrame').src=url;
  document.getElementById('editorOverlay').style.display='flex';
}

document.getElementById('grid').addEventListener('click',e=>{
  if(e.target.matches('button')){
    const i=e.target.dataset.i;
    const act=e.target.dataset.act;
    if(act==='open') window.open(items[i].url,'_blank');
    if(act==='editHere') openEditor(items[i].url);
  }
});

document.getElementById('closeEditor').onclick=()=>{
  document.getElementById('editorOverlay').style.display='none';
  document.getElementById('editorFrame').src='';
};

window.addEventListener('keydown',e=>{
  if(e.key==='Escape') document.getElementById('closeEditor').click();
});
</script>
</body>
</html>
